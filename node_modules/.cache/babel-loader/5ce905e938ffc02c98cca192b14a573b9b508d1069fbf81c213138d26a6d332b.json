{"ast":null,"code":"\"use strict\";\n\n// Which updates have the following fields?\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EntityCache = void 0;\nconst Utils_1 = require(\"./Utils\");\nconst Helpers_1 = require(\"./Helpers\");\nconst tl_1 = require(\"./tl\");\nconst big_integer_1 = __importDefault(require(\"big-integer\"));\nclass EntityCache {\n  constructor() {\n    this.cacheMap = new Map();\n  }\n  add(entities) {\n    const temp = [];\n    if (!(0, Helpers_1.isArrayLike)(entities)) {\n      if (entities != undefined) {\n        if (typeof entities == \"object\") {\n          if (\"chats\" in entities) {\n            temp.push(...entities.chats);\n          }\n          if (\"users\" in entities) {\n            temp.push(...entities.users);\n          }\n          if (\"user\" in entities) {\n            temp.push(entities.user);\n          }\n        }\n      }\n      if (temp.length) {\n        entities = temp;\n      } else {\n        return;\n      }\n    }\n    for (const entity of entities) {\n      try {\n        const pid = (0, Utils_1.getPeerId)(entity);\n        if (!this.cacheMap.has(pid.toString())) {\n          this.cacheMap.set(pid.toString(), (0, Utils_1.getInputPeer)(entity));\n        }\n      } catch (e) {}\n    }\n  }\n  get(item) {\n    if (item == undefined) {\n      throw new Error(\"No cached entity for the given key\");\n    }\n    item = (0, Helpers_1.returnBigInt)(item);\n    if (item.lesser(big_integer_1.default.zero)) {\n      let res;\n      try {\n        res = this.cacheMap.get((0, Utils_1.getPeerId)(item).toString());\n        if (res) {\n          return res;\n        }\n      } catch (e) {\n        throw new Error(\"Invalid key will not have entity\");\n      }\n    }\n    for (const cls of [tl_1.Api.PeerUser, tl_1.Api.PeerChat, tl_1.Api.PeerChannel]) {\n      const result = this.cacheMap.get((0, Utils_1.getPeerId)(new cls({\n        userId: item,\n        chatId: item,\n        channelId: item\n      })).toString());\n      if (result) {\n        return result;\n      }\n    }\n    throw new Error(\"No cached entity for the given key\");\n  }\n}\nexports.EntityCache = EntityCache;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","EntityCache","Utils_1","require","Helpers_1","tl_1","big_integer_1","constructor","cacheMap","Map","add","entities","temp","isArrayLike","undefined","push","chats","users","user","length","entity","pid","getPeerId","has","toString","set","getInputPeer","e","get","item","Error","returnBigInt","lesser","default","zero","res","cls","Api","PeerUser","PeerChat","PeerChannel","result","userId","chatId","channelId"],"sources":["C:/Users/Rodrick/Documents/telegram-media-downloader/node_modules/telegram/entityCache.js"],"sourcesContent":["\"use strict\";\n// Which updates have the following fields?\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EntityCache = void 0;\nconst Utils_1 = require(\"./Utils\");\nconst Helpers_1 = require(\"./Helpers\");\nconst tl_1 = require(\"./tl\");\nconst big_integer_1 = __importDefault(require(\"big-integer\"));\nclass EntityCache {\n    constructor() {\n        this.cacheMap = new Map();\n    }\n    add(entities) {\n        const temp = [];\n        if (!(0, Helpers_1.isArrayLike)(entities)) {\n            if (entities != undefined) {\n                if (typeof entities == \"object\") {\n                    if (\"chats\" in entities) {\n                        temp.push(...entities.chats);\n                    }\n                    if (\"users\" in entities) {\n                        temp.push(...entities.users);\n                    }\n                    if (\"user\" in entities) {\n                        temp.push(entities.user);\n                    }\n                }\n            }\n            if (temp.length) {\n                entities = temp;\n            }\n            else {\n                return;\n            }\n        }\n        for (const entity of entities) {\n            try {\n                const pid = (0, Utils_1.getPeerId)(entity);\n                if (!this.cacheMap.has(pid.toString())) {\n                    this.cacheMap.set(pid.toString(), (0, Utils_1.getInputPeer)(entity));\n                }\n            }\n            catch (e) { }\n        }\n    }\n    get(item) {\n        if (item == undefined) {\n            throw new Error(\"No cached entity for the given key\");\n        }\n        item = (0, Helpers_1.returnBigInt)(item);\n        if (item.lesser(big_integer_1.default.zero)) {\n            let res;\n            try {\n                res = this.cacheMap.get((0, Utils_1.getPeerId)(item).toString());\n                if (res) {\n                    return res;\n                }\n            }\n            catch (e) {\n                throw new Error(\"Invalid key will not have entity\");\n            }\n        }\n        for (const cls of [tl_1.Api.PeerUser, tl_1.Api.PeerChat, tl_1.Api.PeerChannel]) {\n            const result = this.cacheMap.get((0, Utils_1.getPeerId)(new cls({\n                userId: item,\n                chatId: item,\n                channelId: item,\n            })).toString());\n            if (result) {\n                return result;\n            }\n        }\n        throw new Error(\"No cached entity for the given key\");\n    }\n}\nexports.EntityCache = EntityCache;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}