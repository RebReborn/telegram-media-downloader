{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CustomMessage = void 0;\nconst senderGetter_1 = require(\"./senderGetter\");\nconst api_1 = require(\"../api\");\nconst chatGetter_1 = require(\"./chatGetter\");\nconst utils = __importStar(require(\"../../Utils\"));\nconst forward_1 = require(\"./forward\");\nconst file_1 = require(\"./file\");\nconst Helpers_1 = require(\"../../Helpers\");\nconst users_1 = require(\"../../client/users\");\nconst Logger_1 = require(\"../../extensions/Logger\");\nconst messageButton_1 = require(\"./messageButton\");\nconst inspect_1 = require(\"../../inspect\");\n/**\n * This custom class aggregates both {@link Api.Message} and {@link Api.MessageService} to ease accessing their members.<br/>\n * <br/>\n * Remember that this class implements {@link ChatGetter} and {@link SenderGetter}<br/>\n * which means you have access to all their sender and chat properties and methods.\n */\nclass CustomMessage extends senderGetter_1.SenderGetter {\n  [inspect_1.inspect.custom]() {\n    return (0, Helpers_1.betterConsoleLog)(this);\n  }\n  init({\n    id,\n    peerId = undefined,\n    date = undefined,\n    out = undefined,\n    mentioned = undefined,\n    mediaUnread = undefined,\n    silent = undefined,\n    post = undefined,\n    fromId = undefined,\n    replyTo = undefined,\n    message = undefined,\n    fwdFrom = undefined,\n    viaBotId = undefined,\n    media = undefined,\n    replyMarkup = undefined,\n    entities = undefined,\n    views = undefined,\n    editDate = undefined,\n    postAuthor = undefined,\n    groupedId = undefined,\n    fromScheduled = undefined,\n    legacy = undefined,\n    editHide = undefined,\n    pinned = undefined,\n    restrictionReason = undefined,\n    forwards = undefined,\n    replies = undefined,\n    action = undefined,\n    reactions = undefined,\n    noforwards = undefined,\n    ttlPeriod = undefined,\n    _entities = new Map()\n  }) {\n    if (!id) throw new Error(\"id is a required attribute for Message\");\n    let senderId = undefined;\n    if (fromId) {\n      senderId = utils.getPeerId(fromId);\n    } else if (peerId) {\n      if (post || !out && peerId instanceof api_1.Api.PeerUser) {\n        senderId = utils.getPeerId(peerId);\n      }\n    }\n    // Common properties to all messages\n    this._entities = _entities;\n    this.out = out;\n    this.mentioned = mentioned;\n    this.mediaUnread = mediaUnread;\n    this.silent = silent;\n    this.post = post;\n    this.post = post;\n    this.fromScheduled = fromScheduled;\n    this.legacy = legacy;\n    this.editHide = editHide;\n    this.ttlPeriod = ttlPeriod;\n    this.id = id;\n    this.fromId = fromId;\n    this.peerId = peerId;\n    this.fwdFrom = fwdFrom;\n    this.viaBotId = viaBotId;\n    this.replyTo = replyTo;\n    this.date = date;\n    this.message = message;\n    this.media = media instanceof api_1.Api.MessageMediaEmpty ? media : undefined;\n    this.replyMarkup = replyMarkup;\n    this.entities = entities;\n    this.views = views;\n    this.forwards = forwards;\n    this.replies = replies;\n    this.editDate = editDate;\n    this.pinned = pinned;\n    this.postAuthor = postAuthor;\n    this.groupedId = groupedId;\n    this.restrictionReason = restrictionReason;\n    this.action = action;\n    this.noforwards = noforwards;\n    this.reactions = reactions;\n    this._client = undefined;\n    this._text = undefined;\n    this._file = undefined;\n    this._replyMessage = undefined;\n    this._buttons = undefined;\n    this._buttonsFlat = undefined;\n    this._buttonsCount = 0;\n    this._viaBot = undefined;\n    this._viaInputBot = undefined;\n    this._actionEntities = undefined;\n    // Note: these calls would reset the client\n    chatGetter_1.ChatGetter.initChatClass(this, {\n      chatPeer: peerId,\n      broadcast: post\n    });\n    senderGetter_1.SenderGetter.initSenderClass(this, {\n      senderId: senderId ? (0, Helpers_1.returnBigInt)(senderId) : undefined\n    });\n    this._forward = undefined;\n  }\n  constructor(args) {\n    super();\n    this.init(args);\n  }\n  _finishInit(client, entities, inputChat) {\n    this._client = client;\n    const cache = client._entityCache;\n    if (this.senderId) {\n      [this._sender, this._inputSender] = utils._getEntityPair(this.senderId.toString(), entities, cache);\n    }\n    if (this.chatId) {\n      [this._chat, this._inputChat] = utils._getEntityPair(this.chatId.toString(), entities, cache);\n    }\n    if (inputChat) {\n      // This has priority\n      this._inputChat = inputChat;\n    }\n    if (this.viaBotId) {\n      [this._viaBot, this._viaInputBot] = utils._getEntityPair(this.viaBotId.toString(), entities, cache);\n    }\n    if (this.fwdFrom) {\n      this._forward = new forward_1.Forward(this._client, this.fwdFrom, entities);\n    }\n    if (this.action) {\n      if (this.action instanceof api_1.Api.MessageActionChatAddUser || this.action instanceof api_1.Api.MessageActionChatCreate) {\n        this._actionEntities = this.action.users.map(i => entities.get(i.toString()));\n      } else if (this.action instanceof api_1.Api.MessageActionChatDeleteUser) {\n        this._actionEntities = [entities.get(this.action.userId.toString())];\n      } else if (this.action instanceof api_1.Api.MessageActionChatJoinedByLink) {\n        this._actionEntities = [entities.get(utils.getPeerId(new api_1.Api.PeerChannel({\n          channelId: this.action.inviterId\n        })))];\n      } else if (this.action instanceof api_1.Api.MessageActionChannelMigrateFrom) {\n        this._actionEntities = [entities.get(utils.getPeerId(new api_1.Api.PeerChat({\n          chatId: this.action.chatId\n        })))];\n      }\n    }\n  }\n  get client() {\n    return this._client;\n  }\n  get text() {\n    if (this._text === undefined && this._client) {\n      if (!this._client.parseMode) {\n        this._text = this.message;\n      } else {\n        this._text = this._client.parseMode.unparse(this.message || \"\", this.entities || []);\n      }\n    }\n    return this._text || \"\";\n  }\n  set text(value) {\n    this._text = value;\n    if (this._client && this._client.parseMode) {\n      [this.message, this.entities] = this._client.parseMode.parse(value);\n    } else {\n      this.message = value;\n      this.entities = [];\n    }\n  }\n  get rawText() {\n    return this.message || \"\";\n  }\n  /**\n   * @param {string} value\n   */\n  set rawText(value) {\n    this.message = value;\n    this.entities = [];\n    this._text = \"\";\n  }\n  get isReply() {\n    return !!this.replyTo;\n  }\n  get forward() {\n    return this._forward;\n  }\n  async _refetchSender() {\n    await this._reloadMessage();\n  }\n  /**\n   * Re-fetches this message to reload the sender and chat entities,\n   * along with their input versions.\n   * @private\n   */\n  async _reloadMessage() {\n    if (!this._client) return;\n    let msg = undefined;\n    try {\n      const chat = this.isChannel ? await this.getInputChat() : undefined;\n      let temp = await this._client.getMessages(chat, {\n        ids: this.id\n      });\n      if (temp) {\n        msg = temp[0];\n      }\n    } catch (e) {\n      this._client._log.error(\"Got error while trying to finish init message with id \" + this.id);\n      if (this._client._errorHandler) {\n        await this._client._errorHandler(e);\n      }\n      if (this._client._log.canSend(Logger_1.LogLevel.ERROR)) {\n        console.error(e);\n      }\n    }\n    if (msg == undefined) return;\n    this._sender = msg._sender;\n    this._inputSender = msg._inputSender;\n    this._chat = msg._chat;\n    this._inputChat = msg._inputChat;\n    this._viaBot = msg._viaBot;\n    this._viaInputBot = msg._viaInputBot;\n    this._forward = msg._forward;\n    this._actionEntities = msg._actionEntities;\n  }\n  /**\n   * Returns a list of lists of `MessageButton <MessageButton>`, if any.\n   * Otherwise, it returns `undefined`.\n   */\n  get buttons() {\n    if (!this._buttons && this.replyMarkup) {\n      if (!this.inputChat) {\n        return;\n      }\n      try {\n        const bot = this._neededMarkupBot();\n        this._setButtons(this.inputChat, bot);\n      } catch (e) {\n        return;\n      }\n    }\n    return this._buttons;\n  }\n  /**\n   * Returns `buttons` when that property fails (this is rarely needed).\n   */\n  async getButtons() {\n    if (!this.buttons && this.replyMarkup) {\n      const chat = await this.getInputChat();\n      if (!chat) return;\n      let bot;\n      try {\n        bot = this._neededMarkupBot();\n      } catch (e) {\n        await this._reloadMessage();\n        bot = this._neededMarkupBot();\n      }\n      this._setButtons(chat, bot);\n    }\n    return this._buttons;\n  }\n  get buttonCount() {\n    if (!this._buttonsCount) {\n      if (this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup || this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup) {\n        this._buttonsCount = this.replyMarkup.rows.map(r => r.buttons.length).reduce(function (a, b) {\n          return a + b;\n        }, 0);\n      } else {\n        this._buttonsCount = 0;\n      }\n    }\n    return this._buttonsCount;\n  }\n  get file() {\n    if (!this._file) {\n      const media = this.photo || this.document;\n      if (media) {\n        this._file = new file_1.File(media);\n      }\n    }\n    return this._file;\n  }\n  get photo() {\n    if (this.media instanceof api_1.Api.MessageMediaPhoto) {\n      if (this.media.photo instanceof api_1.Api.Photo) return this.media.photo;\n    } else if (this.action instanceof api_1.Api.MessageActionChatEditPhoto) {\n      return this.action.photo;\n    } else {\n      return this.webPreview && this.webPreview.photo instanceof api_1.Api.Photo ? this.webPreview.photo : undefined;\n    }\n    return undefined;\n  }\n  get document() {\n    if (this.media instanceof api_1.Api.MessageMediaDocument) {\n      if (this.media.document instanceof api_1.Api.Document) return this.media.document;\n    } else {\n      const web = this.webPreview;\n      return web && web.document instanceof api_1.Api.Document ? web.document : undefined;\n    }\n    return undefined;\n  }\n  get webPreview() {\n    if (this.media instanceof api_1.Api.MessageMediaWebPage) {\n      if (this.media.webpage instanceof api_1.Api.WebPage) return this.media.webpage;\n    }\n  }\n  get audio() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeAudio, attr => !attr.voice);\n  }\n  get voice() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeAudio, attr => !!attr.voice);\n  }\n  get video() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeVideo);\n  }\n  get videoNote() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeVideo, attr => !!attr.roundMessage);\n  }\n  get gif() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeAnimated);\n  }\n  get sticker() {\n    return this._documentByAttribute(api_1.Api.DocumentAttributeSticker);\n  }\n  get contact() {\n    if (this.media instanceof api_1.Api.MessageMediaContact) {\n      return this.media;\n    }\n  }\n  get game() {\n    if (this.media instanceof api_1.Api.MessageMediaGame) {\n      return this.media.game;\n    }\n  }\n  get geo() {\n    if (this.media instanceof api_1.Api.MessageMediaGeo || this.media instanceof api_1.Api.MessageMediaGeoLive || this.media instanceof api_1.Api.MessageMediaVenue) {\n      return this.media.geo;\n    }\n  }\n  get invoice() {\n    if (this.media instanceof api_1.Api.MessageMediaInvoice) {\n      return this.media;\n    }\n  }\n  get poll() {\n    if (this.media instanceof api_1.Api.MessageMediaPoll) {\n      return this.media;\n    }\n  }\n  get venue() {\n    if (this.media instanceof api_1.Api.MessageMediaVenue) {\n      return this.media;\n    }\n  }\n  get dice() {\n    if (this.media instanceof api_1.Api.MessageMediaDice) {\n      return this.media;\n    }\n  }\n  get actionEntities() {\n    return this._actionEntities;\n  }\n  get viaBot() {\n    return this._viaBot;\n  }\n  get viaInputBot() {\n    return this._viaInputBot;\n  }\n  get replyToMsgId() {\n    var _a;\n    return (_a = this.replyTo) === null || _a === void 0 ? void 0 : _a.replyToMsgId;\n  }\n  get toId() {\n    if (this._client && !this.out && this.isPrivate) {\n      return new api_1.Api.PeerUser({\n        userId: (0, users_1._selfId)(this._client)\n      });\n    }\n    return this.peerId;\n  }\n  getEntitiesText(cls) {\n    let ent = this.entities;\n    if (!ent || ent.length == 0) return;\n    if (cls) {\n      ent = ent.filter(v => v instanceof cls);\n    }\n    const texts = utils.getInnerText(this.message || \"\", ent);\n    const zip = rows => rows[0].map((_, c) => rows.map(row => row[c]));\n    return zip([ent, texts]);\n  }\n  async getReplyMessage() {\n    if (!this._replyMessage && this._client) {\n      if (!this.replyTo) return undefined;\n      // Bots cannot access other bots' messages by their ID.\n      // However they can access them through replies...\n      this._replyMessage = (await this._client.getMessages(this.isChannel ? await this.getInputChat() : undefined, {\n        ids: new api_1.Api.InputMessageReplyTo({\n          id: this.id\n        })\n      }))[0];\n      if (!this._replyMessage) {\n        // ...unless the current message got deleted.\n        //\n        // If that's the case, give it a second chance accessing\n        // directly by its ID.\n        this._replyMessage = (await this._client.getMessages(this.isChannel ? this._inputChat : undefined, {\n          ids: this.replyToMsgId\n        }))[0];\n      }\n    }\n    return this._replyMessage;\n  }\n  async respond(params) {\n    if (this._client) {\n      return this._client.sendMessage(await this.getInputChat(), params);\n    }\n  }\n  async reply(params) {\n    if (this._client) {\n      params.replyTo = this.id;\n      return this._client.sendMessage(await this.getInputChat(), params);\n    }\n  }\n  async forwardTo(entity) {\n    if (this._client) {\n      entity = await this._client.getInputEntity(entity);\n      const params = {\n        messages: [this.id],\n        fromPeer: await this.getInputChat()\n      };\n      return this._client.forwardMessages(entity, params);\n    }\n  }\n  async edit(params) {\n    const param = params;\n    if (this.fwdFrom || !this._client) return undefined;\n    if (param.linkPreview == undefined) {\n      param.linkPreview = !!this.webPreview;\n    }\n    if (param.buttons == undefined) {\n      param.buttons = this.replyMarkup;\n    }\n    param.message = this.id;\n    return this._client.editMessage(await this.getInputChat(), param);\n  }\n  async delete({\n    revoke\n  } = {\n    revoke: false\n  }) {\n    if (this._client) {\n      return this._client.deleteMessages(await this.getInputChat(), [this.id], {\n        revoke\n      });\n    }\n  }\n  async pin(params) {\n    if (this._client) {\n      const entity = await this.getInputChat();\n      if (entity === undefined) {\n        throw Error(\"Failed to pin message due to cannot get input chat.\");\n      }\n      return this._client.pinMessage(entity, this.id, params);\n    }\n  }\n  async unpin(params) {\n    if (this._client) {\n      const entity = await this.getInputChat();\n      if (entity === undefined) {\n        throw Error(\"Failed to unpin message due to cannot get input chat.\");\n      }\n      return this._client.unpinMessage(entity, this.id, params);\n    }\n  }\n  async downloadMedia(params) {\n    // small hack for patched method\n    if (this._client) return this._client.downloadMedia(this, params || {});\n  }\n  async markAsRead() {\n    if (this._client) {\n      const entity = await this.getInputChat();\n      if (entity === undefined) {\n        throw Error(`Failed to mark message id ${this.id} as read due to cannot get input chat.`);\n      }\n      return this._client.markAsRead(entity, this.id);\n    }\n  }\n  async click({\n    i,\n    j,\n    text,\n    filter,\n    data,\n    sharePhone,\n    shareGeo,\n    password\n  }) {\n    if (!this.client) {\n      return;\n    }\n    if (data) {\n      const chat = await this.getInputChat();\n      if (!chat) {\n        return;\n      }\n      const button = new api_1.Api.KeyboardButtonCallback({\n        text: \"\",\n        data: data\n      });\n      return await new messageButton_1.MessageButton(this.client, button, chat, undefined, this.id).click({\n        sharePhone: sharePhone,\n        shareGeo: shareGeo,\n        password: password\n      });\n    }\n    if (this.poll) {\n      function findPoll(answers) {\n        if (i != undefined) {\n          if (Array.isArray(i)) {\n            const corrects = [];\n            for (let x = 0; x < i.length; x++) {\n              corrects.push(answers[x].option);\n            }\n            return corrects;\n          }\n          return [answers[i].option];\n        }\n        if (text != undefined) {\n          if (typeof text == \"function\") {\n            for (const answer of answers) {\n              if (text(answer.text)) {\n                return [answer.option];\n              }\n            }\n          } else {\n            for (const answer of answers) {\n              if (answer.text.text == text) {\n                return [answer.option];\n              }\n            }\n          }\n          return;\n        }\n        if (filter != undefined) {\n          for (const answer of answers) {\n            if (filter(answer)) {\n              return [answer.option];\n            }\n          }\n          return;\n        }\n      }\n      const options = findPoll(this.poll.poll.answers) || [];\n      return await this.client.invoke(new api_1.Api.messages.SendVote({\n        peer: this.inputChat,\n        msgId: this.id,\n        options: options\n      }));\n    }\n    if (!(await this.getButtons())) {\n      return; // Accessing the property sets this._buttons[_flat]\n    }\n    function findButton(self) {\n      if (!self._buttonsFlat || !self._buttons) {\n        return;\n      }\n      if (Array.isArray(i)) {\n        i = i[0];\n      }\n      if (text != undefined) {\n        if (typeof text == \"function\") {\n          for (const button of self._buttonsFlat) {\n            if (text(button.text)) {\n              return button;\n            }\n          }\n        } else {\n          for (const button of self._buttonsFlat) {\n            if (button.text == text) {\n              return button;\n            }\n          }\n        }\n        return;\n      }\n      if (filter != undefined) {\n        for (const button of self._buttonsFlat) {\n          if (filter(button)) {\n            return button;\n          }\n        }\n        return;\n      }\n      if (i == undefined) {\n        i = 0;\n      }\n      if (j == undefined) {\n        return self._buttonsFlat[i];\n      } else {\n        return self._buttons[i][j];\n      }\n    }\n    const button = findButton(this);\n    if (button) {\n      return await button.click({\n        sharePhone: sharePhone,\n        shareGeo: shareGeo,\n        password: password\n      });\n    }\n  }\n  /**\n   * Helper methods to set the buttons given the input sender and chat.\n   */\n  _setButtons(chat, bot) {\n    if (this.client && (this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup || this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup)) {\n      this._buttons = [];\n      this._buttonsFlat = [];\n      for (const row of this.replyMarkup.rows) {\n        const tmp = [];\n        for (const button of row.buttons) {\n          const btn = new messageButton_1.MessageButton(this.client, button, chat, bot, this.id);\n          tmp.push(btn);\n          this._buttonsFlat.push(btn);\n        }\n        this._buttons.push(tmp);\n      }\n    }\n  }\n  /**\n   *Returns the input peer of the bot that's needed for the reply markup.\n    This is necessary for `KeyboardButtonSwitchInline` since we need\n   to know what bot we want to start. Raises ``Error`` if the bot\n   cannot be found but is needed. Returns `None` if it's not needed.\n   */\n  _neededMarkupBot() {\n    if (!this.client || this.replyMarkup == undefined) {\n      return;\n    }\n    if (!(this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup || this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup)) {\n      return;\n    }\n    for (const row of this.replyMarkup.rows) {\n      for (const button of row.buttons) {\n        if (button instanceof api_1.Api.KeyboardButtonSwitchInline) {\n          if (button.samePeer || !this.viaBotId) {\n            const bot = this._inputSender;\n            if (!bot) throw new Error(\"No input sender\");\n            return bot;\n          } else {\n            const ent = this.client._entityCache.get(this.viaBotId);\n            if (!ent) throw new Error(\"No input sender\");\n            return ent;\n          }\n        }\n      }\n    }\n  }\n  // TODO fix this\n  _documentByAttribute(kind, condition) {\n    const doc = this.document;\n    if (doc) {\n      for (const attr of doc.attributes) {\n        if (attr instanceof kind) {\n          if (condition == undefined || typeof condition == \"function\" && condition(attr)) {\n            return doc;\n          }\n          return undefined;\n        }\n      }\n    }\n  }\n}\nexports.CustomMessage = CustomMessage;","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","exports","CustomMessage","senderGetter_1","require","api_1","chatGetter_1","utils","forward_1","file_1","Helpers_1","users_1","Logger_1","messageButton_1","inspect_1","SenderGetter","inspect","custom","betterConsoleLog","init","id","peerId","date","out","mentioned","mediaUnread","silent","post","fromId","replyTo","message","fwdFrom","viaBotId","media","replyMarkup","entities","views","editDate","postAuthor","groupedId","fromScheduled","legacy","editHide","pinned","restrictionReason","forwards","replies","action","reactions","noforwards","ttlPeriod","_entities","Map","Error","senderId","getPeerId","Api","PeerUser","MessageMediaEmpty","_client","_text","_file","_replyMessage","_buttons","_buttonsFlat","_buttonsCount","_viaBot","_viaInputBot","_actionEntities","ChatGetter","initChatClass","chatPeer","broadcast","initSenderClass","returnBigInt","_forward","constructor","args","_finishInit","client","inputChat","cache","_entityCache","_sender","_inputSender","_getEntityPair","toString","chatId","_chat","_inputChat","Forward","MessageActionChatAddUser","MessageActionChatCreate","users","map","i","MessageActionChatDeleteUser","userId","MessageActionChatJoinedByLink","PeerChannel","channelId","inviterId","MessageActionChannelMigrateFrom","PeerChat","text","parseMode","unparse","parse","rawText","isReply","forward","_refetchSender","_reloadMessage","msg","chat","isChannel","getInputChat","temp","getMessages","ids","e","_log","error","_errorHandler","canSend","LogLevel","ERROR","console","buttons","bot","_neededMarkupBot","_setButtons","getButtons","buttonCount","ReplyInlineMarkup","ReplyKeyboardMarkup","rows","r","length","reduce","a","b","file","photo","document","File","MessageMediaPhoto","Photo","MessageActionChatEditPhoto","webPreview","MessageMediaDocument","Document","web","MessageMediaWebPage","webpage","WebPage","audio","_documentByAttribute","DocumentAttributeAudio","attr","voice","video","DocumentAttributeVideo","videoNote","roundMessage","gif","DocumentAttributeAnimated","sticker","DocumentAttributeSticker","contact","MessageMediaContact","game","MessageMediaGame","geo","MessageMediaGeo","MessageMediaGeoLive","MessageMediaVenue","invoice","MessageMediaInvoice","poll","MessageMediaPoll","venue","dice","MessageMediaDice","actionEntities","viaBot","viaInputBot","replyToMsgId","_a","toId","isPrivate","_selfId","getEntitiesText","cls","ent","filter","texts","getInnerText","zip","_","c","row","getReplyMessage","InputMessageReplyTo","respond","params","sendMessage","reply","forwardTo","entity","getInputEntity","messages","fromPeer","forwardMessages","edit","param","linkPreview","editMessage","delete","revoke","deleteMessages","pin","pinMessage","unpin","unpinMessage","downloadMedia","markAsRead","click","j","data","sharePhone","shareGeo","password","button","KeyboardButtonCallback","MessageButton","findPoll","answers","Array","isArray","corrects","x","push","option","answer","options","invoke","SendVote","peer","msgId","findButton","self","tmp","btn","KeyboardButtonSwitchInline","samePeer","kind","condition","doc","attributes"],"sources":["C:/Users/Rodrick/Documents/telegram-media-downloader/node_modules/telegram/tl/custom/message.js"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CustomMessage = void 0;\nconst senderGetter_1 = require(\"./senderGetter\");\nconst api_1 = require(\"../api\");\nconst chatGetter_1 = require(\"./chatGetter\");\nconst utils = __importStar(require(\"../../Utils\"));\nconst forward_1 = require(\"./forward\");\nconst file_1 = require(\"./file\");\nconst Helpers_1 = require(\"../../Helpers\");\nconst users_1 = require(\"../../client/users\");\nconst Logger_1 = require(\"../../extensions/Logger\");\nconst messageButton_1 = require(\"./messageButton\");\nconst inspect_1 = require(\"../../inspect\");\n/**\n * This custom class aggregates both {@link Api.Message} and {@link Api.MessageService} to ease accessing their members.<br/>\n * <br/>\n * Remember that this class implements {@link ChatGetter} and {@link SenderGetter}<br/>\n * which means you have access to all their sender and chat properties and methods.\n */\nclass CustomMessage extends senderGetter_1.SenderGetter {\n    [inspect_1.inspect.custom]() {\n        return (0, Helpers_1.betterConsoleLog)(this);\n    }\n    init({ id, peerId = undefined, date = undefined, out = undefined, mentioned = undefined, mediaUnread = undefined, silent = undefined, post = undefined, fromId = undefined, replyTo = undefined, message = undefined, fwdFrom = undefined, viaBotId = undefined, media = undefined, replyMarkup = undefined, entities = undefined, views = undefined, editDate = undefined, postAuthor = undefined, groupedId = undefined, fromScheduled = undefined, legacy = undefined, editHide = undefined, pinned = undefined, restrictionReason = undefined, forwards = undefined, replies = undefined, action = undefined, reactions = undefined, noforwards = undefined, ttlPeriod = undefined, _entities = new Map(), }) {\n        if (!id)\n            throw new Error(\"id is a required attribute for Message\");\n        let senderId = undefined;\n        if (fromId) {\n            senderId = utils.getPeerId(fromId);\n        }\n        else if (peerId) {\n            if (post || (!out && peerId instanceof api_1.Api.PeerUser)) {\n                senderId = utils.getPeerId(peerId);\n            }\n        }\n        // Common properties to all messages\n        this._entities = _entities;\n        this.out = out;\n        this.mentioned = mentioned;\n        this.mediaUnread = mediaUnread;\n        this.silent = silent;\n        this.post = post;\n        this.post = post;\n        this.fromScheduled = fromScheduled;\n        this.legacy = legacy;\n        this.editHide = editHide;\n        this.ttlPeriod = ttlPeriod;\n        this.id = id;\n        this.fromId = fromId;\n        this.peerId = peerId;\n        this.fwdFrom = fwdFrom;\n        this.viaBotId = viaBotId;\n        this.replyTo = replyTo;\n        this.date = date;\n        this.message = message;\n        this.media = media instanceof api_1.Api.MessageMediaEmpty ? media : undefined;\n        this.replyMarkup = replyMarkup;\n        this.entities = entities;\n        this.views = views;\n        this.forwards = forwards;\n        this.replies = replies;\n        this.editDate = editDate;\n        this.pinned = pinned;\n        this.postAuthor = postAuthor;\n        this.groupedId = groupedId;\n        this.restrictionReason = restrictionReason;\n        this.action = action;\n        this.noforwards = noforwards;\n        this.reactions = reactions;\n        this._client = undefined;\n        this._text = undefined;\n        this._file = undefined;\n        this._replyMessage = undefined;\n        this._buttons = undefined;\n        this._buttonsFlat = undefined;\n        this._buttonsCount = 0;\n        this._viaBot = undefined;\n        this._viaInputBot = undefined;\n        this._actionEntities = undefined;\n        // Note: these calls would reset the client\n        chatGetter_1.ChatGetter.initChatClass(this, { chatPeer: peerId, broadcast: post });\n        senderGetter_1.SenderGetter.initSenderClass(this, {\n            senderId: senderId ? (0, Helpers_1.returnBigInt)(senderId) : undefined,\n        });\n        this._forward = undefined;\n    }\n    constructor(args) {\n        super();\n        this.init(args);\n    }\n    _finishInit(client, entities, inputChat) {\n        this._client = client;\n        const cache = client._entityCache;\n        if (this.senderId) {\n            [this._sender, this._inputSender] = utils._getEntityPair(this.senderId.toString(), entities, cache);\n        }\n        if (this.chatId) {\n            [this._chat, this._inputChat] = utils._getEntityPair(this.chatId.toString(), entities, cache);\n        }\n        if (inputChat) {\n            // This has priority\n            this._inputChat = inputChat;\n        }\n        if (this.viaBotId) {\n            [this._viaBot, this._viaInputBot] = utils._getEntityPair(this.viaBotId.toString(), entities, cache);\n        }\n        if (this.fwdFrom) {\n            this._forward = new forward_1.Forward(this._client, this.fwdFrom, entities);\n        }\n        if (this.action) {\n            if (this.action instanceof api_1.Api.MessageActionChatAddUser ||\n                this.action instanceof api_1.Api.MessageActionChatCreate) {\n                this._actionEntities = this.action.users.map((i) => entities.get(i.toString()));\n            }\n            else if (this.action instanceof api_1.Api.MessageActionChatDeleteUser) {\n                this._actionEntities = [\n                    entities.get(this.action.userId.toString()),\n                ];\n            }\n            else if (this.action instanceof api_1.Api.MessageActionChatJoinedByLink) {\n                this._actionEntities = [\n                    entities.get(utils.getPeerId(new api_1.Api.PeerChannel({\n                        channelId: this.action.inviterId,\n                    }))),\n                ];\n            }\n            else if (this.action instanceof api_1.Api.MessageActionChannelMigrateFrom) {\n                this._actionEntities = [\n                    entities.get(utils.getPeerId(new api_1.Api.PeerChat({ chatId: this.action.chatId }))),\n                ];\n            }\n        }\n    }\n    get client() {\n        return this._client;\n    }\n    get text() {\n        if (this._text === undefined && this._client) {\n            if (!this._client.parseMode) {\n                this._text = this.message;\n            }\n            else {\n                this._text = this._client.parseMode.unparse(this.message || \"\", this.entities || []);\n            }\n        }\n        return this._text || \"\";\n    }\n    set text(value) {\n        this._text = value;\n        if (this._client && this._client.parseMode) {\n            [this.message, this.entities] = this._client.parseMode.parse(value);\n        }\n        else {\n            this.message = value;\n            this.entities = [];\n        }\n    }\n    get rawText() {\n        return this.message || \"\";\n    }\n    /**\n     * @param {string} value\n     */\n    set rawText(value) {\n        this.message = value;\n        this.entities = [];\n        this._text = \"\";\n    }\n    get isReply() {\n        return !!this.replyTo;\n    }\n    get forward() {\n        return this._forward;\n    }\n    async _refetchSender() {\n        await this._reloadMessage();\n    }\n    /**\n     * Re-fetches this message to reload the sender and chat entities,\n     * along with their input versions.\n     * @private\n     */\n    async _reloadMessage() {\n        if (!this._client)\n            return;\n        let msg = undefined;\n        try {\n            const chat = this.isChannel ? await this.getInputChat() : undefined;\n            let temp = await this._client.getMessages(chat, { ids: this.id });\n            if (temp) {\n                msg = temp[0];\n            }\n        }\n        catch (e) {\n            this._client._log.error(\"Got error while trying to finish init message with id \" +\n                this.id);\n            if (this._client._errorHandler) {\n                await this._client._errorHandler(e);\n            }\n            if (this._client._log.canSend(Logger_1.LogLevel.ERROR)) {\n                console.error(e);\n            }\n        }\n        if (msg == undefined)\n            return;\n        this._sender = msg._sender;\n        this._inputSender = msg._inputSender;\n        this._chat = msg._chat;\n        this._inputChat = msg._inputChat;\n        this._viaBot = msg._viaBot;\n        this._viaInputBot = msg._viaInputBot;\n        this._forward = msg._forward;\n        this._actionEntities = msg._actionEntities;\n    }\n    /**\n     * Returns a list of lists of `MessageButton <MessageButton>`, if any.\n     * Otherwise, it returns `undefined`.\n     */\n    get buttons() {\n        if (!this._buttons && this.replyMarkup) {\n            if (!this.inputChat) {\n                return;\n            }\n            try {\n                const bot = this._neededMarkupBot();\n                this._setButtons(this.inputChat, bot);\n            }\n            catch (e) {\n                return;\n            }\n        }\n        return this._buttons;\n    }\n    /**\n     * Returns `buttons` when that property fails (this is rarely needed).\n     */\n    async getButtons() {\n        if (!this.buttons && this.replyMarkup) {\n            const chat = await this.getInputChat();\n            if (!chat)\n                return;\n            let bot;\n            try {\n                bot = this._neededMarkupBot();\n            }\n            catch (e) {\n                await this._reloadMessage();\n                bot = this._neededMarkupBot();\n            }\n            this._setButtons(chat, bot);\n        }\n        return this._buttons;\n    }\n    get buttonCount() {\n        if (!this._buttonsCount) {\n            if (this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup ||\n                this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup) {\n                this._buttonsCount = this.replyMarkup.rows\n                    .map((r) => r.buttons.length)\n                    .reduce(function (a, b) {\n                    return a + b;\n                }, 0);\n            }\n            else {\n                this._buttonsCount = 0;\n            }\n        }\n        return this._buttonsCount;\n    }\n    get file() {\n        if (!this._file) {\n            const media = this.photo || this.document;\n            if (media) {\n                this._file = new file_1.File(media);\n            }\n        }\n        return this._file;\n    }\n    get photo() {\n        if (this.media instanceof api_1.Api.MessageMediaPhoto) {\n            if (this.media.photo instanceof api_1.Api.Photo)\n                return this.media.photo;\n        }\n        else if (this.action instanceof api_1.Api.MessageActionChatEditPhoto) {\n            return this.action.photo;\n        }\n        else {\n            return this.webPreview && this.webPreview.photo instanceof api_1.Api.Photo\n                ? this.webPreview.photo\n                : undefined;\n        }\n        return undefined;\n    }\n    get document() {\n        if (this.media instanceof api_1.Api.MessageMediaDocument) {\n            if (this.media.document instanceof api_1.Api.Document)\n                return this.media.document;\n        }\n        else {\n            const web = this.webPreview;\n            return web && web.document instanceof api_1.Api.Document\n                ? web.document\n                : undefined;\n        }\n        return undefined;\n    }\n    get webPreview() {\n        if (this.media instanceof api_1.Api.MessageMediaWebPage) {\n            if (this.media.webpage instanceof api_1.Api.WebPage)\n                return this.media.webpage;\n        }\n    }\n    get audio() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeAudio, (attr) => !attr.voice);\n    }\n    get voice() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeAudio, (attr) => !!attr.voice);\n    }\n    get video() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeVideo);\n    }\n    get videoNote() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeVideo, (attr) => !!attr.roundMessage);\n    }\n    get gif() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeAnimated);\n    }\n    get sticker() {\n        return this._documentByAttribute(api_1.Api.DocumentAttributeSticker);\n    }\n    get contact() {\n        if (this.media instanceof api_1.Api.MessageMediaContact) {\n            return this.media;\n        }\n    }\n    get game() {\n        if (this.media instanceof api_1.Api.MessageMediaGame) {\n            return this.media.game;\n        }\n    }\n    get geo() {\n        if (this.media instanceof api_1.Api.MessageMediaGeo ||\n            this.media instanceof api_1.Api.MessageMediaGeoLive ||\n            this.media instanceof api_1.Api.MessageMediaVenue) {\n            return this.media.geo;\n        }\n    }\n    get invoice() {\n        if (this.media instanceof api_1.Api.MessageMediaInvoice) {\n            return this.media;\n        }\n    }\n    get poll() {\n        if (this.media instanceof api_1.Api.MessageMediaPoll) {\n            return this.media;\n        }\n    }\n    get venue() {\n        if (this.media instanceof api_1.Api.MessageMediaVenue) {\n            return this.media;\n        }\n    }\n    get dice() {\n        if (this.media instanceof api_1.Api.MessageMediaDice) {\n            return this.media;\n        }\n    }\n    get actionEntities() {\n        return this._actionEntities;\n    }\n    get viaBot() {\n        return this._viaBot;\n    }\n    get viaInputBot() {\n        return this._viaInputBot;\n    }\n    get replyToMsgId() {\n        var _a;\n        return (_a = this.replyTo) === null || _a === void 0 ? void 0 : _a.replyToMsgId;\n    }\n    get toId() {\n        if (this._client && !this.out && this.isPrivate) {\n            return new api_1.Api.PeerUser({\n                userId: (0, users_1._selfId)(this._client),\n            });\n        }\n        return this.peerId;\n    }\n    getEntitiesText(cls) {\n        let ent = this.entities;\n        if (!ent || ent.length == 0)\n            return;\n        if (cls) {\n            ent = ent.filter((v) => v instanceof cls);\n        }\n        const texts = utils.getInnerText(this.message || \"\", ent);\n        const zip = (rows) => rows[0].map((_, c) => rows.map((row) => row[c]));\n        return zip([ent, texts]);\n    }\n    async getReplyMessage() {\n        if (!this._replyMessage && this._client) {\n            if (!this.replyTo)\n                return undefined;\n            // Bots cannot access other bots' messages by their ID.\n            // However they can access them through replies...\n            this._replyMessage = (await this._client.getMessages(this.isChannel ? await this.getInputChat() : undefined, {\n                ids: new api_1.Api.InputMessageReplyTo({ id: this.id }),\n            }))[0];\n            if (!this._replyMessage) {\n                // ...unless the current message got deleted.\n                //\n                // If that's the case, give it a second chance accessing\n                // directly by its ID.\n                this._replyMessage = (await this._client.getMessages(this.isChannel ? this._inputChat : undefined, {\n                    ids: this.replyToMsgId,\n                }))[0];\n            }\n        }\n        return this._replyMessage;\n    }\n    async respond(params) {\n        if (this._client) {\n            return this._client.sendMessage((await this.getInputChat()), params);\n        }\n    }\n    async reply(params) {\n        if (this._client) {\n            params.replyTo = this.id;\n            return this._client.sendMessage((await this.getInputChat()), params);\n        }\n    }\n    async forwardTo(entity) {\n        if (this._client) {\n            entity = await this._client.getInputEntity(entity);\n            const params = {\n                messages: [this.id],\n                fromPeer: (await this.getInputChat()),\n            };\n            return this._client.forwardMessages(entity, params);\n        }\n    }\n    async edit(params) {\n        const param = params;\n        if (this.fwdFrom || !this._client)\n            return undefined;\n        if (param.linkPreview == undefined) {\n            param.linkPreview = !!this.webPreview;\n        }\n        if (param.buttons == undefined) {\n            param.buttons = this.replyMarkup;\n        }\n        param.message = this.id;\n        return this._client.editMessage((await this.getInputChat()), param);\n    }\n    async delete({ revoke } = { revoke: false }) {\n        if (this._client) {\n            return this._client.deleteMessages(await this.getInputChat(), [this.id], {\n                revoke,\n            });\n        }\n    }\n    async pin(params) {\n        if (this._client) {\n            const entity = await this.getInputChat();\n            if (entity === undefined) {\n                throw Error(\"Failed to pin message due to cannot get input chat.\");\n            }\n            return this._client.pinMessage(entity, this.id, params);\n        }\n    }\n    async unpin(params) {\n        if (this._client) {\n            const entity = await this.getInputChat();\n            if (entity === undefined) {\n                throw Error(\"Failed to unpin message due to cannot get input chat.\");\n            }\n            return this._client.unpinMessage(entity, this.id, params);\n        }\n    }\n    async downloadMedia(params) {\n        // small hack for patched method\n        if (this._client)\n            return this._client.downloadMedia(this, params || {});\n    }\n    async markAsRead() {\n        if (this._client) {\n            const entity = await this.getInputChat();\n            if (entity === undefined) {\n                throw Error(`Failed to mark message id ${this.id} as read due to cannot get input chat.`);\n            }\n            return this._client.markAsRead(entity, this.id);\n        }\n    }\n    async click({ i, j, text, filter, data, sharePhone, shareGeo, password, }) {\n        if (!this.client) {\n            return;\n        }\n        if (data) {\n            const chat = await this.getInputChat();\n            if (!chat) {\n                return;\n            }\n            const button = new api_1.Api.KeyboardButtonCallback({\n                text: \"\",\n                data: data,\n            });\n            return await new messageButton_1.MessageButton(this.client, button, chat, undefined, this.id).click({\n                sharePhone: sharePhone,\n                shareGeo: shareGeo,\n                password: password,\n            });\n        }\n        if (this.poll) {\n            function findPoll(answers) {\n                if (i != undefined) {\n                    if (Array.isArray(i)) {\n                        const corrects = [];\n                        for (let x = 0; x < i.length; x++) {\n                            corrects.push(answers[x].option);\n                        }\n                        return corrects;\n                    }\n                    return [answers[i].option];\n                }\n                if (text != undefined) {\n                    if (typeof text == \"function\") {\n                        for (const answer of answers) {\n                            if (text(answer.text)) {\n                                return [answer.option];\n                            }\n                        }\n                    }\n                    else {\n                        for (const answer of answers) {\n                            if (answer.text.text == text) {\n                                return [answer.option];\n                            }\n                        }\n                    }\n                    return;\n                }\n                if (filter != undefined) {\n                    for (const answer of answers) {\n                        if (filter(answer)) {\n                            return [answer.option];\n                        }\n                    }\n                    return;\n                }\n            }\n            const options = findPoll(this.poll.poll.answers) || [];\n            return await this.client.invoke(new api_1.Api.messages.SendVote({\n                peer: this.inputChat,\n                msgId: this.id,\n                options: options,\n            }));\n        }\n        if (!(await this.getButtons())) {\n            return; // Accessing the property sets this._buttons[_flat]\n        }\n        function findButton(self) {\n            if (!self._buttonsFlat || !self._buttons) {\n                return;\n            }\n            if (Array.isArray(i)) {\n                i = i[0];\n            }\n            if (text != undefined) {\n                if (typeof text == \"function\") {\n                    for (const button of self._buttonsFlat) {\n                        if (text(button.text)) {\n                            return button;\n                        }\n                    }\n                }\n                else {\n                    for (const button of self._buttonsFlat) {\n                        if (button.text == text) {\n                            return button;\n                        }\n                    }\n                }\n                return;\n            }\n            if (filter != undefined) {\n                for (const button of self._buttonsFlat) {\n                    if (filter(button)) {\n                        return button;\n                    }\n                }\n                return;\n            }\n            if (i == undefined) {\n                i = 0;\n            }\n            if (j == undefined) {\n                return self._buttonsFlat[i];\n            }\n            else {\n                return self._buttons[i][j];\n            }\n        }\n        const button = findButton(this);\n        if (button) {\n            return await button.click({\n                sharePhone: sharePhone,\n                shareGeo: shareGeo,\n                password: password,\n            });\n        }\n    }\n    /**\n     * Helper methods to set the buttons given the input sender and chat.\n     */\n    _setButtons(chat, bot) {\n        if (this.client &&\n            (this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup ||\n                this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup)) {\n            this._buttons = [];\n            this._buttonsFlat = [];\n            for (const row of this.replyMarkup.rows) {\n                const tmp = [];\n                for (const button of row.buttons) {\n                    const btn = new messageButton_1.MessageButton(this.client, button, chat, bot, this.id);\n                    tmp.push(btn);\n                    this._buttonsFlat.push(btn);\n                }\n                this._buttons.push(tmp);\n            }\n        }\n    }\n    /**\n     *Returns the input peer of the bot that's needed for the reply markup.\n\n     This is necessary for `KeyboardButtonSwitchInline` since we need\n     to know what bot we want to start. Raises ``Error`` if the bot\n     cannot be found but is needed. Returns `None` if it's not needed.\n     */\n    _neededMarkupBot() {\n        if (!this.client || this.replyMarkup == undefined) {\n            return;\n        }\n        if (!(this.replyMarkup instanceof api_1.Api.ReplyInlineMarkup ||\n            this.replyMarkup instanceof api_1.Api.ReplyKeyboardMarkup)) {\n            return;\n        }\n        for (const row of this.replyMarkup.rows) {\n            for (const button of row.buttons) {\n                if (button instanceof api_1.Api.KeyboardButtonSwitchInline) {\n                    if (button.samePeer || !this.viaBotId) {\n                        const bot = this._inputSender;\n                        if (!bot)\n                            throw new Error(\"No input sender\");\n                        return bot;\n                    }\n                    else {\n                        const ent = this.client._entityCache.get(this.viaBotId);\n                        if (!ent)\n                            throw new Error(\"No input sender\");\n                        return ent;\n                    }\n                }\n            }\n        }\n    }\n    // TODO fix this\n    _documentByAttribute(kind, condition) {\n        const doc = this.document;\n        if (doc) {\n            for (const attr of doc.attributes) {\n                if (attr instanceof kind) {\n                    if (condition == undefined ||\n                        (typeof condition == \"function\" && condition(attr))) {\n                        return doc;\n                    }\n                    return undefined;\n                }\n            }\n        }\n    }\n}\nexports.CustomMessage = CustomMessage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}