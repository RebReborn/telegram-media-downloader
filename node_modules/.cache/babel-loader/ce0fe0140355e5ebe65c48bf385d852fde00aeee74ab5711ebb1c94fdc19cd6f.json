{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{TelegramClient}from'telegram';import{StringSession}from'telegram/sessions';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[tab,setTab]=useState('auth');const[apiId,setApiId]=useState('');const[apiHash,setApiHash]=useState('');const[phone,setPhone]=useState('');const[code,setCode]=useState('');const[client,setClient]=useState(null);const[authStatus,setAuthStatus]=useState({text:'',type:''});const[mediaItems,setMediaItems]=useState([]);const[progress,setProgress]=useState(0);const[chatInput,setChatInput]=useState('');const[isWaitingForCode,setIsWaitingForCode]=useState(false);const[isDownloading,setIsDownloading]=useState(false);const verificationResolver=useRef(null);// Cleanup effect\nuseEffect(()=>{return()=>{verificationResolver.current=null;};},[]);const connect=async()=>{try{// Validate inputs\nif(!apiId.match(/^\\d+$/)){throw new Error('API ID must be numeric');}if(!apiHash.match(/^[a-f0-9]{32}$/i)){throw new Error('Invalid API Hash format (32 characters hexadecimal)');}const cleanPhone=phone.trim();if(!cleanPhone.match(/^\\+?\\d{10,15}$/)){throw new Error('Invalid phone number format. Use +1234567890');}setAuthStatus({text:'Connecting...',type:'loading'});setIsWaitingForCode(false);setCode('');const sessionKey='telegramSession';const savedSession=localStorage.getItem(sessionKey)||'';const newClient=new TelegramClient(new StringSession(savedSession),parseInt(apiId),apiHash,{connectionRetries:3});await newClient.start({phoneNumber:cleanPhone,phoneCode:async()=>{setAuthStatus({text:'Enter verification code sent to your phone',type:'info'});setIsWaitingForCode(true);return new Promise(resolve=>{verificationResolver.current=resolve;});},onError:err=>{setAuthStatus({text:`Error: ${err.message}`,type:'error'});setIsWaitingForCode(false);}});const session=newClient.session.save();localStorage.setItem(sessionKey,session);setClient(newClient);setAuthStatus({text:'Connected successfully!',type:'success'});setTab('download');}catch(err){setAuthStatus({text:`Error: ${err.message}`,type:'error'});setIsWaitingForCode(false);}};const verifyCode=()=>{if(!code.trim()){setAuthStatus({text:'Please enter verification code',type:'error'});return;}if(verificationResolver.current){setAuthStatus({text:'Verifying...',type:'loading'});verificationResolver.current(code);verificationResolver.current=null;setIsWaitingForCode(false);}else{setAuthStatus({text:'Verification failed. Try connecting again.',type:'error'});}};const fetchMedia=async()=>{if(!chatInput.trim()||!client)return;try{setProgress(10);const entity=await client.getInputEntity(chatInput.trim());setProgress(50);const messages=await client.getMessages(entity,{limit:100});setProgress(80);const items=messages.filter(m=>m.media).map(m=>({id:m.id,type:m.photo?'photo':m.video?'video':'file',filename:m.photo?`photo_${m.id}.jpg`:m.video?`video_${m.id}.mp4`:`file_${m.id}.dat`,message:m}));setMediaItems(items);setProgress(100);setTimeout(()=>setProgress(0),1000);}catch(err){setAuthStatus({texté£¼:`Fetch error: ${err.message}`,type:'error'});setProgress(0);}};const downloadFile=async mediaItem=>{try{setIsDownloading(true);const buffer=await client.downloadMedia(mediaItem.message);const blob=new Blob([buffer]);const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=mediaItem.filename;a.click();URL.revokeObjectURL(url);setIsDownloading(false);}catch(err){setAuthStatus({text:`Download failed: ${err.message}`,type:'error'});setIsDownloading(false);}};const disconnect=()=>{localStorage.removeItem('telegramSession');setClient(null);setTab('auth');setAuthStatus({text:'Disconnected',type:'info'});setMediaItems([]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTab('auth'),className:`tab ${tab==='auth'?'active':''}`,children:\"Authentication\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTab('download'),className:`tab ${tab==='download'?'active':''}`,disabled:!client,children:\"Download Media\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTab('about'),className:`tab ${tab==='about'?'active':''}`,children:\"About\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[tab==='auth'&&/*#__PURE__*/_jsxs(\"div\",{className:\"auth-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Telegram Login\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"API ID (from my.telegram.org)\",value:apiId,onChange:e=>setApiId(e.target.value.trim()),type:\"text\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"API Hash\",value:apiHash,onChange:e=>setApiHash(e.target.value.trim()),type:\"password\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Phone (+1234567890)\",value:phone,onChange:e=>setPhone(e.target.value.trim()),type:\"tel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:connect,className:\"connect-btn\",children:\"Connect to Telegram\"}),client&&/*#__PURE__*/_jsx(\"button\",{onClick:disconnect,className:\"disconnect-btn\",children:\"Disconnect\"}),authStatus.text&&/*#__PURE__*/_jsx(\"div\",{className:`status ${authStatus.type}`,children:authStatus.text}),isWaitingForCode&&/*#__PURE__*/_jsxs(\"div\",{className:\"verification-box\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Verification Code\",value:code,onChange:e=>setCode(e.target.value.trim()),type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:verifyCode,className:\"verify-btn\",disabled:!code.trim(),children:\"Verify Code\"})]})]}),tab==='download'&&client&&/*#__PURE__*/_jsxs(\"div\",{className:\"download-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Download Media\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Chat ID or @username\",value:chatInput,onChange:e=>setChatInput(e.target.value),type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchMedia,className:\"fetch-btn\",disabled:progress>0&&progress<100,children:\"Fetch Media\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"media-grid\",children:mediaItems.length>0?mediaItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"media-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"media-preview\",children:[item.type==='photo'?'ðŸ“·':item.type==='video'?'ðŸŽ¥':'ðŸ“„',/*#__PURE__*/_jsx(\"span\",{className:\"filename\",children:item.filename})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadFile(item),className:\"download-btn\",disabled:isDownloading,children:isDownloading?'Downloading...':'Download'})]},item.id)):/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:progress>0&&progress<100?'Loading media...':'No media found. Enter a chat ID and click \"Fetch Media\"'})}),progress>0&&progress<100&&/*#__PURE__*/_jsx(\"div\",{className:\"progress-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"progress-bar\",style:{width:`${progress}%`},children:[progress,\"%\"]})})]}),tab==='about'&&/*#__PURE__*/_jsxs(\"div\",{className:\"about-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"About This App\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This application allows you to download media from Telegram chats.\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"How to use:\"}),/*#__PURE__*/_jsxs(\"ol\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Get your API ID and Hash from my.telegram.org\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Enter your credentials in the Authentication tab\"}),/*#__PURE__*/_jsx(\"li\",{children:\"After connecting, go to Download Media tab\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Enter a chat ID or username to fetch media\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"disclaimer\",children:\"Note: This app runs entirely in your browser. Your credentials are not stored or sent to any server.\"})]})]})]});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}